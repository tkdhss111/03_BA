abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
mtext(text = TeX('p'), side = 2, line = 4, cex = 2, las = 2)
mtext(text = TeX('p'), side = 2, line = 3, cex = 2, las = 2)
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 2.0, cex.main = 2.0, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "")
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3, cex = 2)
mtext(text = TeX('$p$'),      side = 2, line = 3, cex = 2, las = 2)
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
mtext(text = TeX('$p$'),      side = 2, line = 4, cex = 2, las = 2)
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 2.0, cex.main = 2.0, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "")
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 2)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 2, las = 2)
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
matlines(x = x, y = f(x), lty = 2, col = "gray")
matlines(x = x, y = f(x), lty = 1, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 2.0, cex.main = 2.0, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "")
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 2)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 2, las = 2)
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
matlines(x = x, y = f(x), lty = 1, col = "blue")
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 2.0, cex.main = 2.0, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "")
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 2)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 2, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 2.0, cex.main = 2.0, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "第１種の過誤の生起確率")
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 2)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 2, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 2)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 2, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 2)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 2, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
at.x <- seq(0, 100, 10)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 1.5)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 1.5, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
at.x <- seq(0, 100, 2)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 1.5)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 1.5, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
at.x <- seq(0, 100, 5)
at.y <- seq(0, 1, 0.1)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 1.5)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 1.5, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.5)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
at.x <- seq(0, 100, 5)
at.y <- seq(0, 1, 0.1)
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 1.5)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 1.5, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
at.x <- seq(0, 100, 5)
at.y <- seq(0, 1, 0.1)
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 1.5)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 1.5, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
source("C:/Users/hss/AQUOS/Default_Folder/TIU/lectures/02_stats/tex/fig/chi2_distribution.R", encoding = 'UTF-8')
par(mar = c(4, 5, 2, 1) + 0.1,
cex.lab = 1.5, cex.main = 1.5, cex.axis = 1.)
matplot(x = 1, y = 1, type = "n", bty = "L",
xaxt = "n", yaxt = "n", xaxs = 'i', yaxs = 'i',
xlim = c(0, max(x)), ylim = c(0, 1),
ylab = "", xlab = "", main = "多重検定で第１種の過誤がおこる確率")
at.x <- seq(0, 100, 5)
at.y <- seq(0, 1, 0.1)
abline(h = at.y, v = at.x, col = "gray",  lty = 2, lwd = 0.5)
axis(1, at = at.x, labels = at.x, las = 1)
axis(2, at = at.y, labels = sprintf("%0.1f", at.y), las = 2)
mtext(text = TeX("検定回数"), side = 1, line = 3,   cex = 1.5)
mtext(text = TeX('$p$'),      side = 2, line = 3.5, cex = 1.5, las = 2)
matlines(x = x, y = f(x), lty = 1, lwd = 2, col = "blue")
choose(16,3)
choose(6,3)
choose(15,3)
choose(13,3)
13*22
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/02_stats/tex/fig/hypothesis_tests.R", echo=TRUE)
getwd()
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/02_stats/tex/fig/hypothesis_tests.R", echo=TRUE)
knitr::opts_chunk$set(
echo = TRUE,
message = TRUE,
warning = TRUE
)
d <- read.csv("heart.data.csv")
str(d)
head(d)
summary(d)
head(d)
tail(d)
head(d)
tail(d)
d <- read.csv("heart.data.csv")
str(d)
head(d)
tail(d)
pairs(d, pch = 16, col = COL[2])
# カラーパレット
# (https://www.rapidtables.com/web/color/RGB_Color.html)
COL <- c(rgb(255,   0,   0,  255, max = 255), # 赤
rgb(  0,   0, 255,  255, max = 255), # 青
rgb(  0, 155,   0,  255, max = 255)) # 緑
pairs(d, pch = 16, col = COL[2])
#matplot(x, y, pch = 1)
#grid()
d <- read.csv("heart.data.csv")[, -1]
str(d)
head(d)
tail(d)
summary(d)
# カラーパレット
# (https://www.rapidtables.com/web/color/RGB_Color.html)
COL <- c(rgb(255,   0,   0,  255, max = 255), # 赤
rgb(  0,   0, 255,  255, max = 255), # 青
rgb(  0, 155,   0,  255, max = 255)) # 緑
pairs(d, pch = 16, col = COL[2])
#matplot(x, y, pch = 1)
#grid()
pairs(d, pch = 16, col = COL[2])
#matplot(x, y, pch = 1)
#grid()
library(psych)
pairs.panels(d)
pairs(d, pch = 16, col = COL[2])
#matplot(x, y, pch = 1)
#grid()
library(psych)
pairs.panels(d)
fit <- lm(heart.disease ~ biking + smoking, data = heart.data)
data(auto_mpg)
rm(list = ls())
d <- read.csv("auto-mpg.data")
get.wd()
getwd()
setwd("C:\Users\hss\0_tkd\1_hss\TIU\01_ds\03_BA\data\auto-mpg")
setwd("~/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg")
setwd("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg")
getwd()
head(d)
head(d)
d <- read.csv("auto-mpg.data")
head(d)
d <- read.table("auto-mpg.data")
head(d)
summary(d)
str(d)
library(data.table)
d <- fread("auto-mpg.data")
d
str(d)
d <- fread("auto-mpg-clean.data")
rm(list = ls())
setwd("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg")
getwd()
library(data.table)
d <- fread("auto-mpg-clean.data")
d
head(d)
str(d)
auto.mpg.clean <- read.delim("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg-clean.data", header=FALSE)
View(auto.mpg.clean)
summary(d)
colnames(d) <- c("燃費",     # MPG -> km/L
"排気筒数",
"排気量",   # cu.in. -> cc
"馬力",     # HP
"車体重量", # Lb -> kg
"加速性能", # second
"型式年",   # yy
"生産国",   # 米国，欧州，日本
"車名")
d
colnames(d) <- c("燃費",     # MPG -> km/L
"排気筒数",
"排気量",   # cu.in. -> cc
"馬力",     # HP
"車体重量", # Lb -> kg
"加速性能", # second
"型式年",   # yy
"生産国",   # 米国，欧州，日本
"車名")
d <- fread("auto-mpg-clean.data")
d
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
d <- read.table("auto-mpg-clean.data")
d
colnames(d) <- c("燃費",     # MPG -> km/L
"気筒数",
"排気量",   # cu.in. -> cc
"馬力",     # HP
"車体重量", # Lb -> kg
"加速性能", # second
"型式年",   # yy
"生産国",   # 米国，欧州，日本
"車名")
d
haed(d)
head(d)
rm(list = ls())
setwd("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg")
getwd()
d0 <- read.table("auto-mpg-clean.data")
d0
colnames(d0) <- c("燃費",     # MPG -> km/L
"気筒数",
"排気量",   # cu.in. -> cc
"馬力",     # HP
"車体重量", # Lb -> kg
"加速性能", # second
"型式年",   # yy
"生産国",   # 米国，欧州，日本
"車名")
head(d0)
d1 <- d0
d1[, "燃費"] <- d0[, "燃費"] * 0.425144 # MPG -> km/L
d1
d1[, "排気量"] <- d0[, "排気量"] * 16.387 # cu.in. -> cc
d1
head(d1)
d1[, "車体重量"] <- d0[, "車体重量"] * 0.453592 # Lb -> kg
head(d1)
d1[d1[, "生産国"] == 1, "生産国"] <- "アメ車"
d1[d1[, "生産国"] == 2, "生産国"] <- "欧州車"
d1[d1[, "生産国"] == 3, "生産国"] <- "日本車"
head(d1)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
60*1.60934
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
d2 <- round(d1, 1)
head(d2)
d2 <- round(d1, 1)
head(d2)
head(d1)
d2 <- round(d1, 1)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
head(d1)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
hist(d1[, "燃費"])
library(psych)
pairs.panels(d)
pairs.panels(d1)
d2 <- d1[, c("燃費", "排気量", "車体重量", "加速性能")]
library(psych)
pairs.panels(d2)
fit <- lm(.~ 燃費, data = d1)
fit <- lm(~ 燃費, data = d1)
fit <- lm(燃費~., data = d1)
summary(fit)
fit <- lm(燃費 ~ 排気量 + 車体重量 + 加速性能 + 分類, data = d1)
summary(fit)
d1$経年 <- d1[, "製造年"] - max(d1[, "製造年"])
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
fit <- lm(燃費 ~ 排気量 + 車体重量 + 加速性能 + 分類 + 経年, data = d1)
summary(fit)
fit <- lm(燃費 ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 加速性能 + 分類 + 経年, data = d1)
summary(fit)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
plot(fit)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
stepAIC(fit)
library(MASS)
stepAIC(fit)
fit1 <- lm(燃費 ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 加速性能 + 分類 + 経年, data = d1)
fit2 <- lm(燃費 ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 分類 + 経年, data = d1)
summary(fit1, fit2)
summary(fit1)
summary(fit2)
summary(fit1)
summary(fit2)
summary(fit2)
summary(fit1)
summary(fit2)
plot(fit2)
fit3 <- lm(燃費 ~ (気筒数 + 排気量 + 馬力 + 車体重量 + 分類 + 経年)^2, data = d1)
summary(fit3)
stepAIC(fit3)
summary(fit3)
stepAIC(fit2)
stepAIC(fit3)
summary(fit3)
fit1 <- lm(log(燃費) ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 加速性能 + 分類 + 経年, data = d1)
summary(fit1)
plot(fit1)
fit4 <- lm(log(燃費) ~ (気筒数 + 排気量 + 馬力 + 車体重量 + 分類 + 経年)^2, data = d1)
summary(fit4)
pairs.panels(d2)
stepAIC(fit4)
fitstep4 <- stepAIC(fit4)
summary(fitstep4)
summary(fit4)
summary(fitstep4)
n <- nrow(d1)
n <- nrow(d1)
ii.train <- sample(1:n, floor(n/5))
ii.train
d.train <- d1[ii.train, ]
d.test <- d1-ii.train, ]
d.test <- d1[-ii.train, ]
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
pred <- predict(fit1, newdata = d.test)
pred
yhat1 <- predict(fit1, newdata = d.test)
MAPE <- function(y, yhat) mean(abs(yhat - y)/y * 100))
MAPE <- function(y, yhat) mean(abs(yhat - y)/y * 100)
get.MAPE <- function(y, yhat) mean(abs(yhat - y)/y * 100)
MAPE1 <- get.MAPE(y = d.test$燃費, yhat1)
(MAPE1 <- get.MAPE(y = d.test$燃費, yhat1))
y <- d.test$燃費
yhat1 <- predict(fit1, newdata = d.test)
(MAPE1 <- get.MAPE(y, yhat1))
e <- yhat1 - y
e
yhat1
yhat1 <- exp(predict(fit1, newdata = d.test))
e <- yhat1 - y
e
get.MAPE <- function(y, yhat) mean(abs(yhat - y)/y * 100)
(MAPE1 <- get.MAPE(y, yhat1))
yhat1
(MAPE1 <- get.MAPE(y, yhat1))
(MAPE4 <- get.MAPE(y, yhat4))
yhat4 <- exp(predict(fit4, newdata = d.test))
(MAPE4 <- get.MAPE(y, yhat4))
fit4 <- lm(log(燃費) ~ (気筒数 + 排気量 + 馬力 + 車体重量 + 分類 + 経年)^2, data = d.train)
summary(fit4)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
yhat4 <- exp(predict(fitstep4, newdata = d.test))
summary(fitstep4)
(MAPE4 <- get.MAPE(y, yhat4))
(MAPE1 <- get.MAPE(y, yhat1))
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
yhat3 <- exp(predict(fit3, newdata = d.test))
(MAPE3 <- get.MAPE(y, yhat3))
yhat3 <- predict(fit3, newdata = d.test)
(MAPE3 <- get.MAPE(y, yhat3))
fit1 <- lm(燃費 ~ 気筒数 + 1/排気量 + 1/馬力 + 1/車体重量 + 加速性能 + 分類 + 経年, data = d.train)
summary(fit1)
summary(fit1)
fit1 <- lm(燃費 ~ 気筒数 + I(1/排気量) + I(1/馬力) + I(1/車体重量) + 加速性能 + 分類 + 経年, data = d.train)
summary(fit1)
yhat1 <- predict(fit1, newdata = d.test)
get.MAPE <- function(y, yhat) mean(abs(yhat - y)/y * 100)
(MAPE1 <- get.MAPE(y, yhat1))
library(psych)
pairs.panels(d2)
d2$燃費 <- log(d2$燃費)
pairs.panels(d2)
d2 <- d1[, c("燃費", "気筒数", "排気量", "馬力", "車体重量", "加速性能", "経年")]
pairs.panels(d2)
d2$燃費 <- 1/d2$燃費
d2 <- d1[, c("燃費", "気筒数", "排気量", "馬力", "車体重量", "加速性能", "経年")]
library(psych)
d2$燃費 <- 1/d2$燃費
pairs.panels(d2)
fit2 <- lm(燃費 ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 分類 + 経年, data = d.train)
summary(fit2)
fit <- lm(燃費 ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 加速性能 + 分類 + 経年, data = d.train)
bc <- boxcox(fit)
yhat <- predict(bc, newdata = d.test)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
summary(fit)
summary(fit1)
fit0 <- lm(燃費 ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 加速性能 + 分類 + 経年, data = d.train)
summary(fit0)
fit <- lm(I(1/燃費) ~ 気筒数 + 排気量 + 馬力 + 車体重量 + 加速性能 + 分類 + 経年, data = d.train)
summary(fit)
#d2$燃費 <- 1/d2$燃費
pairs.panels(d2)
#d2$燃費 <- 1/d2$燃費
pairs.panels(d2)
d2$燃費 <- 1/d2$燃費
pairs.panels(d2)
library(psych)
d2$燃費 <- log(1/d2$燃費)
pairs.panels(d2)
d2 <- d1[, c("燃費", "気筒数", "排気量", "馬力", "車体重量", "加速性能", "経年")]
library(psych)
#d2$燃費 <- log(1/d2$燃費)
pairs.panels(d2)
d2 <- d1[, c("燃費", "気筒数", "排気量", "馬力", "車体重量", "加速性能", "経年")]
#d2$燃費 <- log(1/d2$燃費)
d2$排気量 <- 1/d2$排気量
pairs.panels(d2)
n <- nrow(d1)
ii.train <- sample(1:n, floor(n/5))
d.train <- d1[ii.train, ]
d.test <- d1[-ii.train, ]
source("C:/Users/hss/0_tkd/1_hss/TIU/01_ds/03_BA/data/auto-mpg/auto-mpg.R", echo=TRUE)
summary(fit0)
